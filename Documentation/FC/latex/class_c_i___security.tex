\hypertarget{class_c_i___security}{}\section{C\+I\+\_\+\+Security Class Reference}
\label{class_c_i___security}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
Inheritance diagram for C\+I\+\_\+\+Security\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_c_i___security}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class_c_i___security_a095c5d389db211932136b53f25f39685}{\+\_\+\+\_\+construct} ()
\item 
\hyperlink{class_c_i___security_a03c037268db0c2e6221b65a736eaee07}{csrf\+\_\+verify} ()
\item 
\hyperlink{class_c_i___security_a55b1380b93b71ab3d9873bb967c2b9bb}{csrf\+\_\+set\+\_\+cookie} ()
\item 
\hyperlink{class_c_i___security_a3d09c1dc706abfaad987661805c28a06}{csrf\+\_\+show\+\_\+error} ()
\item 
\hyperlink{class_c_i___security_a1644fd8967db3a1b94988d730ca34991}{get\+\_\+csrf\+\_\+hash} ()
\item 
\hyperlink{class_c_i___security_a00640f51b90b7d946e9d3a4f0c9f628e}{get\+\_\+csrf\+\_\+token\+\_\+name} ()
\item 
\hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{xss\+\_\+clean} (\$str, \$is\+\_\+image=F\+A\+L\+S\+E)
\item 
\hyperlink{class_c_i___security_ae2f831d3f277e1c03730b28fd1734186}{xss\+\_\+hash} ()
\item 
\hyperlink{class_c_i___security_a7d1d64e6798b98cb46fcdb304a4e1de2}{get\+\_\+random\+\_\+bytes} (\$length)
\item 
\hyperlink{class_c_i___security_a8bec9918f4d35c9e6340e1dc6a32ba14}{entity\+\_\+decode} (\$str, \$charset=N\+U\+L\+L)
\item 
\hyperlink{class_c_i___security_aaba16489285496bdc03fd12f699a08f6}{sanitize\+\_\+filename} (\$str, \$relative\+\_\+path=F\+A\+L\+S\+E)
\item 
\hyperlink{class_c_i___security_abb836a42971c7bc641588db779c6ab1d}{strip\+\_\+image\+\_\+tags} (\$str)
\end{DoxyCompactItemize}
\subsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class_c_i___security_a7ea55abf18a7d5ed32df02a8144b72e2}{\$filename\+\_\+bad\+\_\+chars}
\item 
\hyperlink{class_c_i___security_af10158dd74b75f1d337e83102d6b82ce}{\$charset} = \textquotesingle{}U\+T\+F-\/8\textquotesingle{}
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class_c_i___security_adfb0e251ae35ae40303a302d253c3ab2}{\+\_\+compact\+\_\+exploded\+\_\+words} (\$matches)
\item 
\hyperlink{class_c_i___security_a37c160ddffea957e9eb03dbfd3471a78}{\+\_\+remove\+\_\+evil\+\_\+attributes} (\$str, \$is\+\_\+image)
\item 
\hyperlink{class_c_i___security_af67689597607833df370031fb799c92b}{\+\_\+sanitize\+\_\+naughty\+\_\+html} (\$matches)
\item 
\hyperlink{class_c_i___security_a6b1744acaf85e05c65ab17242dea4f06}{\+\_\+js\+\_\+link\+\_\+removal} (\$match)
\item 
\hyperlink{class_c_i___security_a5c5e91dc8e3df0174e4e074dd375a8db}{\+\_\+js\+\_\+img\+\_\+removal} (\$match)
\item 
\hyperlink{class_c_i___security_ae16451bcdc769285c499cbf8068b3523}{\+\_\+convert\+\_\+attribute} (\$match)
\item 
\hyperlink{class_c_i___security_aa385a9c7527f5eece656b9cac73979d3}{\+\_\+filter\+\_\+attributes} (\$str)
\item 
\hyperlink{class_c_i___security_a5289832cb3ae9cee3c12e82ede958874}{\+\_\+decode\+\_\+entity} (\$match)
\item 
\hyperlink{class_c_i___security_a61217e43f888cdf8afb1fba16b5cd9f6}{\+\_\+do\+\_\+never\+\_\+allowed} (\$str)
\item 
\hyperlink{class_c_i___security_a7064dd5501c1dfab05ba6ac8838beb01}{\+\_\+csrf\+\_\+set\+\_\+hash} ()
\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class_c_i___security_aca426a0e87199bfa36c7401a1d06a419}{\$\+\_\+xss\+\_\+hash}
\item 
\hyperlink{class_c_i___security_a8bf24cc529f04164ac20d892ce20d721}{\$\+\_\+csrf\+\_\+hash}
\item 
\hyperlink{class_c_i___security_af86a83f20de2a3c522bf690d4080c08e}{\$\+\_\+csrf\+\_\+expire} = 7200
\item 
\hyperlink{class_c_i___security_a6752ebca4be235c079785a87a693d932}{\$\+\_\+csrf\+\_\+token\+\_\+name} = \textquotesingle{}ci\+\_\+csrf\+\_\+token\textquotesingle{}
\item 
\hyperlink{class_c_i___security_a52043f2c9ffb0e14eade8e67a0172a82}{\$\+\_\+csrf\+\_\+cookie\+\_\+name} = \textquotesingle{}ci\+\_\+csrf\+\_\+token\textquotesingle{}
\item 
\hyperlink{class_c_i___security_ab883fab930a1c4a926eaa501ab211823}{\$\+\_\+never\+\_\+allowed\+\_\+str}
\item 
\hyperlink{class_c_i___security_ac502ee17d09eb8bbd70a6fb1f9515503}{\$\+\_\+never\+\_\+allowed\+\_\+regex}
\end{DoxyCompactItemize}


\subsection{Constructor \& Destructor Documentation}
\hypertarget{class_c_i___security_a095c5d389db211932136b53f25f39685}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+\+\_\+construct@{\+\_\+\+\_\+construct}}
\index{\+\_\+\+\_\+construct@{\+\_\+\+\_\+construct}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\+\_\+\+\_\+construct()}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+\+\_\+construct (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{class_c_i___security_a095c5d389db211932136b53f25f39685}
Class constructor

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


\subsection{Member Function Documentation}
\hypertarget{class_c_i___security_adfb0e251ae35ae40303a302d253c3ab2}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+compact\+\_\+exploded\+\_\+words@{\+\_\+compact\+\_\+exploded\+\_\+words}}
\index{\+\_\+compact\+\_\+exploded\+\_\+words@{\+\_\+compact\+\_\+exploded\+\_\+words}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\+\_\+compact\+\_\+exploded\+\_\+words(\$matches)}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+compact\+\_\+exploded\+\_\+words (
\begin{DoxyParamCaption}
\item[{}]{\$matches}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\label{class_c_i___security_adfb0e251ae35ae40303a302d253c3ab2}
Compact Exploded Words

Callback method for \hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{xss\+\_\+clean()} to remove whitespace from things like \textquotesingle{}j a v a s c r i p t\textquotesingle{}.

-\/by \hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{C\+I\+\_\+\+Security\+::xss\+\_\+clean()} 
\begin{DoxyParams}[1]{Parameters}
array & {\em \$matches} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\hypertarget{class_c_i___security_ae16451bcdc769285c499cbf8068b3523}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+convert\+\_\+attribute@{\+\_\+convert\+\_\+attribute}}
\index{\+\_\+convert\+\_\+attribute@{\+\_\+convert\+\_\+attribute}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\+\_\+convert\+\_\+attribute(\$match)}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+convert\+\_\+attribute (
\begin{DoxyParamCaption}
\item[{}]{\$match}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\label{class_c_i___security_ae16451bcdc769285c499cbf8068b3523}
Attribute Conversion

-\/by \hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{C\+I\+\_\+\+Security\+::xss\+\_\+clean()} 
\begin{DoxyParams}[1]{Parameters}
array & {\em \$match} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\hypertarget{class_c_i___security_a7064dd5501c1dfab05ba6ac8838beb01}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+csrf\+\_\+set\+\_\+hash@{\+\_\+csrf\+\_\+set\+\_\+hash}}
\index{\+\_\+csrf\+\_\+set\+\_\+hash@{\+\_\+csrf\+\_\+set\+\_\+hash}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\+\_\+csrf\+\_\+set\+\_\+hash()}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+csrf\+\_\+set\+\_\+hash (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\label{class_c_i___security_a7064dd5501c1dfab05ba6ac8838beb01}
Set C\+S\+R\+F Hash and Cookie

\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\hypertarget{class_c_i___security_a5289832cb3ae9cee3c12e82ede958874}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+decode\+\_\+entity@{\+\_\+decode\+\_\+entity}}
\index{\+\_\+decode\+\_\+entity@{\+\_\+decode\+\_\+entity}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\+\_\+decode\+\_\+entity(\$match)}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+decode\+\_\+entity (
\begin{DoxyParamCaption}
\item[{}]{\$match}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\label{class_c_i___security_a5289832cb3ae9cee3c12e82ede958874}
H\+T\+M\+L Entity Decode Callback

-\/by \hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{C\+I\+\_\+\+Security\+::xss\+\_\+clean()} 
\begin{DoxyParams}[1]{Parameters}
array & {\em \$match} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\hypertarget{class_c_i___security_a61217e43f888cdf8afb1fba16b5cd9f6}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+do\+\_\+never\+\_\+allowed@{\+\_\+do\+\_\+never\+\_\+allowed}}
\index{\+\_\+do\+\_\+never\+\_\+allowed@{\+\_\+do\+\_\+never\+\_\+allowed}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\+\_\+do\+\_\+never\+\_\+allowed(\$str)}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+do\+\_\+never\+\_\+allowed (
\begin{DoxyParamCaption}
\item[{}]{\$str}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\label{class_c_i___security_a61217e43f888cdf8afb1fba16b5cd9f6}
Do Never Allowed

-\/by \hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{C\+I\+\_\+\+Security\+::xss\+\_\+clean()} 
\begin{DoxyParams}{Parameters}
{\em string} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\hypertarget{class_c_i___security_aa385a9c7527f5eece656b9cac73979d3}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+filter\+\_\+attributes@{\+\_\+filter\+\_\+attributes}}
\index{\+\_\+filter\+\_\+attributes@{\+\_\+filter\+\_\+attributes}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\+\_\+filter\+\_\+attributes(\$str)}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+filter\+\_\+attributes (
\begin{DoxyParamCaption}
\item[{}]{\$str}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\label{class_c_i___security_aa385a9c7527f5eece656b9cac73979d3}
Filter Attributes

Filters tag attributes for consistency and safety.

-\/by \hyperlink{class_c_i___security_a5c5e91dc8e3df0174e4e074dd375a8db}{C\+I\+\_\+\+Security\+::\+\_\+js\+\_\+img\+\_\+removal()} -\/by \hyperlink{class_c_i___security_a6b1744acaf85e05c65ab17242dea4f06}{C\+I\+\_\+\+Security\+::\+\_\+js\+\_\+link\+\_\+removal()} 
\begin{DoxyParams}[1]{Parameters}
string & {\em \$str} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\hypertarget{class_c_i___security_a5c5e91dc8e3df0174e4e074dd375a8db}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+js\+\_\+img\+\_\+removal@{\+\_\+js\+\_\+img\+\_\+removal}}
\index{\+\_\+js\+\_\+img\+\_\+removal@{\+\_\+js\+\_\+img\+\_\+removal}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\+\_\+js\+\_\+img\+\_\+removal(\$match)}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+js\+\_\+img\+\_\+removal (
\begin{DoxyParamCaption}
\item[{}]{\$match}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\label{class_c_i___security_a5c5e91dc8e3df0174e4e074dd375a8db}
J\+S Image Removal

Callback method for \hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{xss\+\_\+clean()} to sanitize image tags.

This limits the P\+C\+R\+E backtracks, making it more performance friendly and prevents P\+R\+E\+G\+\_\+\+B\+A\+C\+K\+T\+R\+A\+C\+K\+\_\+\+L\+I\+M\+I\+T\+\_\+\+E\+R\+R\+O\+R from being triggered in P\+H\+P 5.\+2+ on image tag heavy strings.

-\/by \hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{C\+I\+\_\+\+Security\+::xss\+\_\+clean()} 
\begin{DoxyParams}[1]{Parameters}
array & {\em \$match} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\hypertarget{class_c_i___security_a6b1744acaf85e05c65ab17242dea4f06}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+js\+\_\+link\+\_\+removal@{\+\_\+js\+\_\+link\+\_\+removal}}
\index{\+\_\+js\+\_\+link\+\_\+removal@{\+\_\+js\+\_\+link\+\_\+removal}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\+\_\+js\+\_\+link\+\_\+removal(\$match)}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+js\+\_\+link\+\_\+removal (
\begin{DoxyParamCaption}
\item[{}]{\$match}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\label{class_c_i___security_a6b1744acaf85e05c65ab17242dea4f06}
J\+S Link Removal

Callback method for \hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{xss\+\_\+clean()} to sanitize links.

This limits the P\+C\+R\+E backtracks, making it more performance friendly and prevents P\+R\+E\+G\+\_\+\+B\+A\+C\+K\+T\+R\+A\+C\+K\+\_\+\+L\+I\+M\+I\+T\+\_\+\+E\+R\+R\+O\+R from being triggered in P\+H\+P 5.\+2+ on link-\/heavy strings.

-\/by \hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{C\+I\+\_\+\+Security\+::xss\+\_\+clean()} 
\begin{DoxyParams}[1]{Parameters}
array & {\em \$match} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\hypertarget{class_c_i___security_a37c160ddffea957e9eb03dbfd3471a78}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+remove\+\_\+evil\+\_\+attributes@{\+\_\+remove\+\_\+evil\+\_\+attributes}}
\index{\+\_\+remove\+\_\+evil\+\_\+attributes@{\+\_\+remove\+\_\+evil\+\_\+attributes}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\+\_\+remove\+\_\+evil\+\_\+attributes(\$str, \$is\+\_\+image)}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+remove\+\_\+evil\+\_\+attributes (
\begin{DoxyParamCaption}
\item[{}]{\$str, }
\item[{}]{\$is\+\_\+image}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\label{class_c_i___security_a37c160ddffea957e9eb03dbfd3471a78}
Remove Evil H\+T\+M\+L Attributes (like event handlers and style)

It removes the evil attribute and either\+:


\begin{DoxyItemize}
\item Everything up until a space. For example, everything between the pipes\+:
\end{DoxyItemize}

{\ttfamily  $<$a $\vert$style=document.\+write(\textquotesingle{}hello\textquotesingle{});alert(\textquotesingle{}world\textquotesingle{});$\vert$ class=link$>$ }


\begin{DoxyItemize}
\item Everything inside the quotes. For example, everything between the pipes\+:
\end{DoxyItemize}

{\ttfamily  $<$a $\vert$style=\char`\"{}document.\+write(\textquotesingle{}hello\textquotesingle{}); alert(\textquotesingle{}world\textquotesingle{});\char`\"{}$\vert$ class=\char`\"{}link\char`\"{}$>$ }


\begin{DoxyParams}[1]{Parameters}
string & {\em \$str} & The string to check \\
\hline
bool & {\em \$is\+\_\+image} & Whether the input is an image \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string The string with the evil attributes removed 
\end{DoxyReturn}
\hypertarget{class_c_i___security_af67689597607833df370031fb799c92b}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\+\_\+sanitize\+\_\+naughty\+\_\+html@{\+\_\+sanitize\+\_\+naughty\+\_\+html}}
\index{\+\_\+sanitize\+\_\+naughty\+\_\+html@{\+\_\+sanitize\+\_\+naughty\+\_\+html}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\+\_\+sanitize\+\_\+naughty\+\_\+html(\$matches)}]{\setlength{\rightskip}{0pt plus 5cm}\+\_\+sanitize\+\_\+naughty\+\_\+html (
\begin{DoxyParamCaption}
\item[{}]{\$matches}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\label{class_c_i___security_af67689597607833df370031fb799c92b}
Sanitize Naughty H\+T\+M\+L

Callback method for \hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{xss\+\_\+clean()} to remove naughty H\+T\+M\+L elements.

-\/by \hyperlink{class_c_i___security_acb759426dbab128d3d8164805225381c}{C\+I\+\_\+\+Security\+::xss\+\_\+clean()} 
\begin{DoxyParams}[1]{Parameters}
array & {\em \$matches} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\hypertarget{class_c_i___security_a55b1380b93b71ab3d9873bb967c2b9bb}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!csrf\+\_\+set\+\_\+cookie@{csrf\+\_\+set\+\_\+cookie}}
\index{csrf\+\_\+set\+\_\+cookie@{csrf\+\_\+set\+\_\+cookie}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{csrf\+\_\+set\+\_\+cookie()}]{\setlength{\rightskip}{0pt plus 5cm}csrf\+\_\+set\+\_\+cookie (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{class_c_i___security_a55b1380b93b71ab3d9873bb967c2b9bb}
C\+S\+R\+F Set Cookie

\begin{DoxyReturn}{Returns}
\hyperlink{class_c_i___security}{C\+I\+\_\+\+Security} 
\end{DoxyReturn}
\hypertarget{class_c_i___security_a3d09c1dc706abfaad987661805c28a06}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!csrf\+\_\+show\+\_\+error@{csrf\+\_\+show\+\_\+error}}
\index{csrf\+\_\+show\+\_\+error@{csrf\+\_\+show\+\_\+error}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{csrf\+\_\+show\+\_\+error()}]{\setlength{\rightskip}{0pt plus 5cm}csrf\+\_\+show\+\_\+error (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{class_c_i___security_a3d09c1dc706abfaad987661805c28a06}
Show C\+S\+R\+F Error

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\hypertarget{class_c_i___security_a03c037268db0c2e6221b65a736eaee07}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!csrf\+\_\+verify@{csrf\+\_\+verify}}
\index{csrf\+\_\+verify@{csrf\+\_\+verify}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{csrf\+\_\+verify()}]{\setlength{\rightskip}{0pt plus 5cm}csrf\+\_\+verify (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{class_c_i___security_a03c037268db0c2e6221b65a736eaee07}
C\+S\+R\+F Verify

\begin{DoxyReturn}{Returns}
\hyperlink{class_c_i___security}{C\+I\+\_\+\+Security} 
\end{DoxyReturn}
\hypertarget{class_c_i___security_a8bec9918f4d35c9e6340e1dc6a32ba14}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!entity\+\_\+decode@{entity\+\_\+decode}}
\index{entity\+\_\+decode@{entity\+\_\+decode}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{entity\+\_\+decode(\$str, \$charset=\+N\+U\+L\+L)}]{\setlength{\rightskip}{0pt plus 5cm}entity\+\_\+decode (
\begin{DoxyParamCaption}
\item[{}]{\$str, }
\item[{}]{\$charset = {\ttfamily NULL}}
\end{DoxyParamCaption}
)}\label{class_c_i___security_a8bec9918f4d35c9e6340e1dc6a32ba14}
H\+T\+M\+L Entities Decode

A replacement for html\+\_\+entity\+\_\+decode()

The reason we are not using html\+\_\+entity\+\_\+decode() by itself is because while it is not technically correct to leave out the semicolon at the end of an entity most browsers will still interpret the entity correctly. html\+\_\+entity\+\_\+decode() does not convert entities without semicolons, so we are left with our own little solution here. Bummer.

\hyperlink{}{string \$str Input  string \$charset Character set  string }\hypertarget{class_c_i___security_a1644fd8967db3a1b94988d730ca34991}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!get\+\_\+csrf\+\_\+hash@{get\+\_\+csrf\+\_\+hash}}
\index{get\+\_\+csrf\+\_\+hash@{get\+\_\+csrf\+\_\+hash}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{get\+\_\+csrf\+\_\+hash()}]{\setlength{\rightskip}{0pt plus 5cm}get\+\_\+csrf\+\_\+hash (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{class_c_i___security_a1644fd8967db3a1b94988d730ca34991}
Get C\+S\+R\+F Hash

\begin{DoxySeeAlso}{See also}
\hyperlink{class_c_i___security_a8bf24cc529f04164ac20d892ce20d721}{C\+I\+\_\+\+Security\+::\$\+\_\+csrf\+\_\+hash} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
string C\+S\+R\+F hash 
\end{DoxyReturn}
\hypertarget{class_c_i___security_a00640f51b90b7d946e9d3a4f0c9f628e}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!get\+\_\+csrf\+\_\+token\+\_\+name@{get\+\_\+csrf\+\_\+token\+\_\+name}}
\index{get\+\_\+csrf\+\_\+token\+\_\+name@{get\+\_\+csrf\+\_\+token\+\_\+name}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{get\+\_\+csrf\+\_\+token\+\_\+name()}]{\setlength{\rightskip}{0pt plus 5cm}get\+\_\+csrf\+\_\+token\+\_\+name (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{class_c_i___security_a00640f51b90b7d946e9d3a4f0c9f628e}
Get C\+S\+R\+F Token Name

\begin{DoxySeeAlso}{See also}
\hyperlink{class_c_i___security_a6752ebca4be235c079785a87a693d932}{C\+I\+\_\+\+Security\+::\$\+\_\+csrf\+\_\+token\+\_\+name} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
string C\+S\+R\+F token name 
\end{DoxyReturn}
\hypertarget{class_c_i___security_a7d1d64e6798b98cb46fcdb304a4e1de2}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!get\+\_\+random\+\_\+bytes@{get\+\_\+random\+\_\+bytes}}
\index{get\+\_\+random\+\_\+bytes@{get\+\_\+random\+\_\+bytes}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{get\+\_\+random\+\_\+bytes(\$length)}]{\setlength{\rightskip}{0pt plus 5cm}get\+\_\+random\+\_\+bytes (
\begin{DoxyParamCaption}
\item[{}]{\$length}
\end{DoxyParamCaption}
)}\label{class_c_i___security_a7d1d64e6798b98cb46fcdb304a4e1de2}
Get random bytes


\begin{DoxyParams}[1]{Parameters}
int & {\em \$length} & Output length \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\hypertarget{class_c_i___security_aaba16489285496bdc03fd12f699a08f6}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!sanitize\+\_\+filename@{sanitize\+\_\+filename}}
\index{sanitize\+\_\+filename@{sanitize\+\_\+filename}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{sanitize\+\_\+filename(\$str, \$relative\+\_\+path=\+F\+A\+L\+S\+E)}]{\setlength{\rightskip}{0pt plus 5cm}sanitize\+\_\+filename (
\begin{DoxyParamCaption}
\item[{}]{\$str, }
\item[{}]{\$relative\+\_\+path = {\ttfamily FALSE}}
\end{DoxyParamCaption}
)}\label{class_c_i___security_aaba16489285496bdc03fd12f699a08f6}
Sanitize Filename


\begin{DoxyParams}[1]{Parameters}
string & {\em \$str} & Input file name \\
\hline
bool & {\em \$relative\+\_\+path} & Whether to preserve paths \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\hypertarget{class_c_i___security_abb836a42971c7bc641588db779c6ab1d}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!strip\+\_\+image\+\_\+tags@{strip\+\_\+image\+\_\+tags}}
\index{strip\+\_\+image\+\_\+tags@{strip\+\_\+image\+\_\+tags}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{strip\+\_\+image\+\_\+tags(\$str)}]{\setlength{\rightskip}{0pt plus 5cm}strip\+\_\+image\+\_\+tags (
\begin{DoxyParamCaption}
\item[{}]{\$str}
\end{DoxyParamCaption}
)}\label{class_c_i___security_abb836a42971c7bc641588db779c6ab1d}
Strip Image Tags


\begin{DoxyParams}[1]{Parameters}
string & {\em \$str} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
string 
\end{DoxyReturn}
\hypertarget{class_c_i___security_acb759426dbab128d3d8164805225381c}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!xss\+\_\+clean@{xss\+\_\+clean}}
\index{xss\+\_\+clean@{xss\+\_\+clean}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{xss\+\_\+clean(\$str, \$is\+\_\+image=\+F\+A\+L\+S\+E)}]{\setlength{\rightskip}{0pt plus 5cm}xss\+\_\+clean (
\begin{DoxyParamCaption}
\item[{}]{\$str, }
\item[{}]{\$is\+\_\+image = {\ttfamily FALSE}}
\end{DoxyParamCaption}
)}\label{class_c_i___security_acb759426dbab128d3d8164805225381c}
X\+S\+S Clean

Sanitizes data so that Cross Site Scripting Hacks can be prevented. This method does a fair amount of work but it is extremely thorough, designed to prevent even the most obscure X\+S\+S attempts. Nothing is ever 100\% foolproof, of course, but I haven\textquotesingle{}t been able to get anything passed the filter.

Note\+: Should only be used to deal with data upon submission. It\textquotesingle{}s not something that should be used for general runtime processing.

\hyperlink{}{Based in part on some code and ideas from Bitflux.  \href{http://ha.ckers.org/xss.html}{\tt http\+://ha.\+ckers.\+org/xss.\+html} To help develop this script I used this great list of vulnerabilities along with a few other hacks I\textquotesingle{}ve harvested from examining vulnerabilities in other programs.  string$\vert$string\mbox{[}\mbox{]} \$str Input data  bool \$is\+\_\+image Whether the input is an image  string }\hypertarget{class_c_i___security_ae2f831d3f277e1c03730b28fd1734186}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!xss\+\_\+hash@{xss\+\_\+hash}}
\index{xss\+\_\+hash@{xss\+\_\+hash}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{xss\+\_\+hash()}]{\setlength{\rightskip}{0pt plus 5cm}xss\+\_\+hash (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{class_c_i___security_ae2f831d3f277e1c03730b28fd1734186}
X\+S\+S Hash

Generates the X\+S\+S hash if needed and returns it.

\begin{DoxySeeAlso}{See also}
\hyperlink{class_c_i___security_aca426a0e87199bfa36c7401a1d06a419}{C\+I\+\_\+\+Security\+::\$\+\_\+xss\+\_\+hash} 
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
string X\+S\+S hash 
\end{DoxyReturn}


\subsection{Field Documentation}
\hypertarget{class_c_i___security_a52043f2c9ffb0e14eade8e67a0172a82}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+csrf\+\_\+cookie\+\_\+name@{\$\+\_\+csrf\+\_\+cookie\+\_\+name}}
\index{\$\+\_\+csrf\+\_\+cookie\+\_\+name@{\$\+\_\+csrf\+\_\+cookie\+\_\+name}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\$\+\_\+csrf\+\_\+cookie\+\_\+name}]{\setlength{\rightskip}{0pt plus 5cm}\$\+\_\+csrf\+\_\+cookie\+\_\+name = \textquotesingle{}ci\+\_\+csrf\+\_\+token\textquotesingle{}\hspace{0.3cm}{\ttfamily [protected]}}\label{class_c_i___security_a52043f2c9ffb0e14eade8e67a0172a82}
\hypertarget{class_c_i___security_af86a83f20de2a3c522bf690d4080c08e}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+csrf\+\_\+expire@{\$\+\_\+csrf\+\_\+expire}}
\index{\$\+\_\+csrf\+\_\+expire@{\$\+\_\+csrf\+\_\+expire}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\$\+\_\+csrf\+\_\+expire}]{\setlength{\rightskip}{0pt plus 5cm}\$\+\_\+csrf\+\_\+expire = 7200\hspace{0.3cm}{\ttfamily [protected]}}\label{class_c_i___security_af86a83f20de2a3c522bf690d4080c08e}
\hypertarget{class_c_i___security_a8bf24cc529f04164ac20d892ce20d721}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+csrf\+\_\+hash@{\$\+\_\+csrf\+\_\+hash}}
\index{\$\+\_\+csrf\+\_\+hash@{\$\+\_\+csrf\+\_\+hash}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\$\+\_\+csrf\+\_\+hash}]{\setlength{\rightskip}{0pt plus 5cm}\$\+\_\+csrf\+\_\+hash\hspace{0.3cm}{\ttfamily [protected]}}\label{class_c_i___security_a8bf24cc529f04164ac20d892ce20d721}
\hypertarget{class_c_i___security_a6752ebca4be235c079785a87a693d932}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+csrf\+\_\+token\+\_\+name@{\$\+\_\+csrf\+\_\+token\+\_\+name}}
\index{\$\+\_\+csrf\+\_\+token\+\_\+name@{\$\+\_\+csrf\+\_\+token\+\_\+name}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\$\+\_\+csrf\+\_\+token\+\_\+name}]{\setlength{\rightskip}{0pt plus 5cm}\$\+\_\+csrf\+\_\+token\+\_\+name = \textquotesingle{}ci\+\_\+csrf\+\_\+token\textquotesingle{}\hspace{0.3cm}{\ttfamily [protected]}}\label{class_c_i___security_a6752ebca4be235c079785a87a693d932}
\hypertarget{class_c_i___security_ac502ee17d09eb8bbd70a6fb1f9515503}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+never\+\_\+allowed\+\_\+regex@{\$\+\_\+never\+\_\+allowed\+\_\+regex}}
\index{\$\+\_\+never\+\_\+allowed\+\_\+regex@{\$\+\_\+never\+\_\+allowed\+\_\+regex}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\$\+\_\+never\+\_\+allowed\+\_\+regex}]{\setlength{\rightskip}{0pt plus 5cm}\$\+\_\+never\+\_\+allowed\+\_\+regex\hspace{0.3cm}{\ttfamily [protected]}}\label{class_c_i___security_ac502ee17d09eb8bbd70a6fb1f9515503}
{\bfseries Initial value\+:}
\begin{DoxyCode}
= array(
        \textcolor{stringliteral}{'javascript\(\backslash\)s*:'},
        \textcolor{stringliteral}{'(document|(document\(\backslash\).)?window)\(\backslash\).(location|on\(\backslash\)w*)'},
        \textcolor{stringliteral}{'expression\(\backslash\)s*(\(\backslash\)(|&\(\backslash\)#40;)'}, 
        \textcolor{stringliteral}{'vbscript\(\backslash\)s*:'}, 
        \textcolor{stringliteral}{'wscript\(\backslash\)s*:'}, 
        \textcolor{stringliteral}{'jscript\(\backslash\)s*:'}, 
        \textcolor{stringliteral}{'vbs\(\backslash\)s*:'}, 
        \textcolor{stringliteral}{'Redirect\(\backslash\)s+30\(\backslash\)d'},
        \textcolor{stringliteral}{"([\(\backslash\)"'])?data\(\backslash\)s*:[^\(\backslash\)\(\backslash\)1]*?base64[^\(\backslash\)\(\backslash\)1]*?,[^\(\backslash\)\(\backslash\)1]*?\(\backslash\)\(\backslash\)1?"}
    )
\end{DoxyCode}
\hypertarget{class_c_i___security_ab883fab930a1c4a926eaa501ab211823}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+never\+\_\+allowed\+\_\+str@{\$\+\_\+never\+\_\+allowed\+\_\+str}}
\index{\$\+\_\+never\+\_\+allowed\+\_\+str@{\$\+\_\+never\+\_\+allowed\+\_\+str}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\$\+\_\+never\+\_\+allowed\+\_\+str}]{\setlength{\rightskip}{0pt plus 5cm}\$\+\_\+never\+\_\+allowed\+\_\+str\hspace{0.3cm}{\ttfamily [protected]}}\label{class_c_i___security_ab883fab930a1c4a926eaa501ab211823}
{\bfseries Initial value\+:}
\begin{DoxyCode}
=   array(
        \textcolor{stringliteral}{'document.cookie'}   => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'document.write'}    => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'.parentNode'}       => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'.innerHTML'}        => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'-moz-binding'}      => \textcolor{stringliteral}{'[removed]'},
        \textcolor{stringliteral}{'<!--'}              => \textcolor{stringliteral}{'&lt;!--'},
        \textcolor{stringliteral}{'-->'}               => \textcolor{stringliteral}{'--&gt;'},
        \textcolor{stringliteral}{'<![CDATA['}         => \textcolor{stringliteral}{'&lt;![CDATA['},
        \textcolor{stringliteral}{'<comment>'}         => \textcolor{stringliteral}{'&lt;comment&gt;'}
    )
\end{DoxyCode}
\hypertarget{class_c_i___security_aca426a0e87199bfa36c7401a1d06a419}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$\+\_\+xss\+\_\+hash@{\$\+\_\+xss\+\_\+hash}}
\index{\$\+\_\+xss\+\_\+hash@{\$\+\_\+xss\+\_\+hash}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\$\+\_\+xss\+\_\+hash}]{\setlength{\rightskip}{0pt plus 5cm}\$\+\_\+xss\+\_\+hash\hspace{0.3cm}{\ttfamily [protected]}}\label{class_c_i___security_aca426a0e87199bfa36c7401a1d06a419}
\hypertarget{class_c_i___security_af10158dd74b75f1d337e83102d6b82ce}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$charset@{\$charset}}
\index{\$charset@{\$charset}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\$charset}]{\setlength{\rightskip}{0pt plus 5cm}\$charset = \textquotesingle{}U\+T\+F-\/8\textquotesingle{}}\label{class_c_i___security_af10158dd74b75f1d337e83102d6b82ce}
\hypertarget{class_c_i___security_a7ea55abf18a7d5ed32df02a8144b72e2}{}\index{C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}!\$filename\+\_\+bad\+\_\+chars@{\$filename\+\_\+bad\+\_\+chars}}
\index{\$filename\+\_\+bad\+\_\+chars@{\$filename\+\_\+bad\+\_\+chars}!C\+I\+\_\+\+Security@{C\+I\+\_\+\+Security}}
\subsubsection[{\$filename\+\_\+bad\+\_\+chars}]{\setlength{\rightskip}{0pt plus 5cm}\$filename\+\_\+bad\+\_\+chars}\label{class_c_i___security_a7ea55abf18a7d5ed32df02a8144b72e2}
{\bfseries Initial value\+:}
\begin{DoxyCode}
=   array(
        \textcolor{stringliteral}{'../'}, \textcolor{stringliteral}{'<!--'}, \textcolor{stringliteral}{'-->'}, \textcolor{charliteral}{'<'}, \textcolor{charliteral}{'>'},
        \textcolor{stringliteral}{"'"}, \textcolor{charliteral}{'"'}, \textcolor{charliteral}{'&'}, \textcolor{charliteral}{'$'}, \textcolor{charliteral}{'#'},
        \textcolor{charliteral}{'\{'}, \textcolor{charliteral}{'\}'}, \textcolor{charliteral}{'['}, \textcolor{charliteral}{']'}, \textcolor{charliteral}{'='},
        \textcolor{charliteral}{';'}, \textcolor{charliteral}{'?'}, \textcolor{stringliteral}{'%20'}, \textcolor{stringliteral}{'%22'},
        \textcolor{stringliteral}{'%3c'},      
        \textcolor{stringliteral}{'%253c'},    
        \textcolor{stringliteral}{'%3e'},      
        \textcolor{stringliteral}{'%0e'},      
        \textcolor{stringliteral}{'%28'},      
        \textcolor{stringliteral}{'%29'},      
        \textcolor{stringliteral}{'%2528'},    
        \textcolor{stringliteral}{'%26'},      
        \textcolor{stringliteral}{'%24'},      
        \textcolor{stringliteral}{'%3f'},      
        \textcolor{stringliteral}{'%3b'},      
        \textcolor{stringliteral}{'%3d'}       
    )
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
D\+:/xampp/htdocs/\+S\+D\+\_\+\+Git/\+L3\+T2/\+F\+C/system/core/\hyperlink{system_2core_2_security_8php}{Security.\+php}\end{DoxyCompactItemize}
